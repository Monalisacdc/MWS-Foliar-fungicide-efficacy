{
  "hash": "5f5cc480547e6a2f74e3dd98674c1d64",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"\"\n---\n\n\n#map\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(scales)\nlibrary(ggspatial) \nlibrary(gsheet)\nlibrary(ggrepel)\nlibrary(cowplot)\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)\nlibrary(sf)\nlibrary(tidyverse)\nmap = gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1JAEAXsmb928CsyCzRbfTP2ilruEof2Qkr_zWUfaknOc/edit?gid=1402084465#gid=1402084465\")\n\nBRA = ne_states(\n  country = \"Brazil\",\n  returnclass = \"sf\"\n)\nlibrary(geobr)\nmunicipios <- read_municipality(code_muni = \"all\", year = 2020)\nmunicipios = municipios %>% filter(name_state ==  c(\"Paraná\",\"São Paulo\", \"Mato Grosso do Sul\",\"Goiás\",\"Minas Gerais\",\"Distrito Federal\"))\n\nstates <- filter(BRA, \n                 name_pt == \"Paraná\"|\n                 name_pt == \"São Paulo\"|\n                 name_pt == \"Mato Grosso do Sul\"|\n                 name_pt == \"Goiás\"|\n                 name_pt == \"Minas Gerais\"|\n                 name_pt == \"Federal\")\nunique(BRA$name_pt)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"Rio Grande do Sul\"   \"Roraima\"             \"Pará\"               \n [4] \"Acre\"                \"Amapá\"               \"Mato Grosso do Sul\" \n [7] \"Paraná\"              \"Santa Catarina\"      \"Amazonas\"           \n[10] \"Rondônia\"            \"Mato Grosso\"         \"Maranhão\"           \n[13] \"Piauí\"               \"Ceará\"               \"Rio Grande do Norte\"\n[16] \"Paraíba\"             \"Pernambuco\"          \"Alagoas\"            \n[19] \"Sergipe\"             \"Bahia\"               \"Espírito Santo\"     \n[22] \"Rio de Janeiro\"      \"São Paulo\"           \"Goiás\"              \n[25] \"Federal\"             \"Minas Gerais\"        \"Tocantins\"          \n```\n\n\n:::\n\n```{.r .cell-code}\nstates = states %>% \n  mutate(id = case_when(\n    name_pt == \"Paraná\" ~ \"PR\",\n    name_pt == \"São Paulo\" ~ \"SP\",\n    name_pt == \"Mato Grosso do Sul\" ~ \"MS\",\n    name_pt == \"Goiás\" ~ \"GO\",\n    name_pt == \"Minas Gerais\" ~ \"MG\",\n    name_pt == \"Federal\" ~ \"DF\"))\n\nSUL = ne_states(\n  country = c(\"Argentina\", \"Uruguay\", \"Paraguay\", \"Colombia\", \"Bolivia\"),\n  returnclass = \"sf\")\n\nbr_sf <- ne_states(geounit = \"brazil\",\n                   returnclass = \"sf\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(cowplot)  \n\nmap3 = map |>  filter(estado != \"PR\")\nmapa_principal <- ggplot() +\n  #geom_sf(data = SUL, fill = \"white\", color = \"white\") +\n  geom_sf(data = BRA, fill = \"white\", color = \"gray60\", size = 0.2)  + \n  geom_sf(data = subset(BRA, postal %in% c(\"GO\", \"MG\", \"PR\", \"MS\", \"SP\", \"DF\")), \n        fill = NA, color = \"black\", size = 1) + \n  geom_text(data = states, aes(x = longitude, y = latitude, label = id), \n            size = 3, hjust = 0.8, color = \"black\", fontface = \"bold\") +\n  geom_point(data = map, aes(x = lon, y = lat, size = n, color = sev), \n             alpha = 0.8) +\n  scale_color_gradientn(colors = c(\"#313695\", \"#74add1\", \"#ffcc00\", \"#fd8d3c\", \"#e31a1c\", \"#800026\"),\n                      breaks = seq(0, 70, by = 15), \n                      limits = c(0, 70)) +\n  scale_size_continuous(range = c(1, 5), breaks = c(1, 5, 12)) +\n  theme_minimal_grid() +\n  coord_sf(xlim = c(-60, -37), ylim = c(-27, -12), expand = FALSE) +\n   guides(size = FALSE,  \n         color = guide_colorbar(title = \"Severity (%)\", \n                                direction = \"horizontal\",\n                                title.position = \"top\"))  +\n    theme(legend.position = c(0.9, 0.01),  \n        legend.justification = c(1, 0),\n         legend.direction = \"horizontal\",\n         legend.title.align = 0.5,\n         panel.border = element_rect(color = \"black\", fill = NA, size = 1))+\n   annotation_north_arrow(location = \"br\", which_north = \"true\", \n                         pad_x = unit(5.86, \"in\"), pad_y = unit(0.3, \"in\"), \n                         style = north_arrow_fancy_orienteering, \n                         height = unit(1.2, \"cm\"), width = unit(1.1, \"cm\")) +\n   annotation_scale(location = \"br\", \n                   width_hint = 0.1, \n                   height = unit(0.2, \"cm\"), \n                   text_cex = 0.6, \n                   pad_x = unit(5.8, \"in\"), \n                   pad_y = unit(0.2, \"in\")) +\n  labs(x = \"Longitude\", y = \"Latitude\")\nmapa_principal\n```\n\n::: {.cell-output-display}\n![](map_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\npr_municipios <- read_municipality(code_muni = \"all\", year = 2020) %>%\n  filter(name_state == \"Paraná\")\n\nBRA <- ne_states(country = \"Brazil\", returnclass = \"sf\")\npr_estado <- BRA %>% filter(name_pt == \"Paraná\")\nmap2 = map |> filter(estado == \"PR\")\n\nmapa_brasil <- ggplot() +\n  geom_sf(data = BRA, fill = \"white\", color = \"black\", size = 0.2) +  \n  geom_sf(data = subset(BRA, postal %in% c(\"GO\", \"MG\", \"PR\", \"MS\", \"SP\")), \n          fill = \"gray40\", color = \"black\", size = 0.6) +  \n  theme_map() +\n    theme(\n    panel.background = element_rect(fill = \"white\", color = NA),  \n    plot.background = element_rect(fill = \"white\", color = NA),   \n    panel.border = element_rect(color = \"black\", fill = NA, size = 1)) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(patchwork)\n\nmapa_principal + \n  inset_element(mapa_brasil, \n                left = 0.8, bottom = 0.7,  \n                right = 0.99, top = 1) \n```\n\n::: {.cell-output-display}\n![](map_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#ggsave(\"map.png\", height=8, width=8, dpi = 600, bg = \"white\")\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}